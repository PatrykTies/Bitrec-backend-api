define(["jquery","d3"],function(t,e){function a(){l(h,y),s(h,y),i(h,y),o(x,500,0)}function n(t,e,a){var n=function(t){return"label-"+t.data.qty};labels=t.selectAll("text").data(e),labels.enter().append("text").attr("class",n).style("fill","#FDFCEA").style("font-size","24px").style("font-weight","700").style("opacity","0"),labels.transition().attr("transform",function(t){return"translate("+a.centroid(t)+")"}).attr("dy",".35em").attr("text-anchor","middle").text(function(t){return t.data.qty}),labels.transition().delay(1e3).duration(1e3).style("opacity","1")}function r(t,a,n){var r=function(t){return"label-"+t.data.qty},l=e.format("%");labels=t.selectAll("text").data(a),labels.enter().append("text").attr("class",r).style("fill","#FDFCEA").style("font-size","24px").style("font-weight","700").style("opacity","0"),labels.transition().attr("transform",function(t){return"translate("+n.centroid(t)+")"}).attr("dy",".35em").attr("text-anchor","middle").text(function(t){return l(t.data.qty/100)}),labels.transition().delay(1e3).duration(1e3).style("opacity","1")}function l(t,a){e.json("js/data/ethnic.json",function(n){function l(t){return t.startAngle+(t.endAngle-t.startAngle)/2}var s=e.layout.pie().sort(null).value(function(t){return t.qty}),i=s(n),o=e.svg.arc().innerRadius(t).outerRadius(a),f=e.svg.arc().outerRadius(.85*d).innerRadius(.8*d),p=e.svg.arc().innerRadius(.9*d).outerRadius(.9*d),h=function(t){return t.data.nationality};m.attr("transform","translate("+c/2+","+u/2+")"),m.append("text").attr("x",0).attr("y",8).style("text-anchor","middle").text("Lorem isd dds");var y=m.select(".arcs");y.selectAll("path.arc").data(i,h).enter().append("path").attr("class","arc").attr("fill",function(t,e){return g[e]}).style("stroke","white").style("stroke-width","1").transition().ease("bounce").duration(1500).attrTween("d",function(t){var a={startAngle:0,endAngle:0},n=e.interpolate(a,t);return function(t){return o(n(t))}}),y.selectAll("path.arc").on("mouseover",function(t){var a=e.select(this);a.style("fill","white"),e.select(".label-"+t.data.qty).style("fill","black")}).on("mouseout",function(t){e.select(this).style("fill",v),e.select(".label-"+t.data.qty).style("fill","#FDFCEA")}),r(y,i,o);var w=m.select(".labels").selectAll("text").data(i,h);w.enter().append("text").attr("dy",".35em").text(function(t){return t.data.nationality}),w.transition().duration(1e3).attrTween("transform",function(t){this._current=this._current||t;var a=e.interpolate(this._current,t);return this._current=a(0),function(t){var e=a(t),n=p.centroid(e);return n[0]=d*(l(e)<Math.PI?1:-1),"translate("+n+")"}}).styleTween("text-anchor",function(t){this._current=this._current||t;var a=e.interpolate(this._current,t);return this._current=a(0),function(t){var e=a(t);return l(e)<Math.PI?"start":"end"}}),w.exit().remove();var b=m.select(".lines").selectAll("polyline").data(i,h);b.enter().append("polyline"),b.style("stroke","white").style("stroke-width","2px").style("opacity",".9").style("fill","none"),b.transition().duration(1e3).attrTween("points",function(t){this._current=this._current||t;var a=e.interpolate(this._current,t);return this._current=a(0),function(t){var e=a(t),n=f.centroid(e),r=p.centroid(e);return r[0]=.95*d*(l(e)<Math.PI?1:-1),[n,p.centroid(e),r]}}),b.exit().remove()})}function s(t,a){e.json("js/data/ethnic.json",function(r){w.select("#chart2 g").remove();var l=e.layout.pie().value(function(t){return t.qty}),s=l(r),i=e.svg.arc().innerRadius(t).outerRadius(a),o=w.append("g").attr("transform","translate(260,160)");o.selectAll("path.arc").data(s).enter().append("path").attr("class","arc").attr("fill",function(t,e){return g[e]}).style("stroke","white").style("stroke-width","1").transition().ease("bounce").duration(2e3).attrTween("d",function(t){var a={startAngle:0,endAngle:0},n=e.interpolate(a,t);return function(t){return i(n(t))}}),o.selectAll("path.arc").on("mouseover",function(t){var a=e.select(this);a.style("fill","white"),e.select(".label-"+t.data.qty).style("fill","black")}).on("mouseout",function(t){e.select(this).style("fill",v),e.select(".label-"+t.data.qty).style("fill","#FDFCEA")}),n(o,s,i)})}function i(t,a){e.json("js/data/positions.json",function(r){b.select("#chart3 g").remove();var l=e.layout.pie().value(function(t){return t.qty}),s=l(r),i=e.svg.arc().innerRadius(t).outerRadius(a),o=b.append("g").attr("transform","translate(260,140)");o.selectAll("path").data(s).enter().append("path").attr("class","arc").attr("fill",function(t,e){return g[e]}).style("stroke","white").style("stroke-width","1").transition().ease("bounce").duration(2500).attrTween("d",function(t){var a={startAngle:0,endAngle:0},n=e.interpolate(a,t);return function(t){return i(n(t))}}),o.selectAll("path.arc").on("mouseover",function(t){var a=e.select(this);a.style("fill","white"),e.select(".label-"+t.data.qty).style("fill","black")}).on("mouseout",function(t){e.select(this).style("fill",v),e.select(".label-"+t.data.qty).style("fill","#FDFCEA")}),n(o,s,i)})}function o(t,a,n){e.json("js/data/workers.json",function(r,l){function s(){var e=t.attr("value");return e==i?!0:void t.attr("value",++e).text(e)}if(r)throw r;var i=l[n].qty;e.timer(s,a)})}var c=500,u=300,d=Math.min(c,u)/2,f=290,p=290,h=80,y=140,v=(2*Math.PI,"rgba(255, 255, 255, 0.5)"),g=[v,v,v,v,v,v,v],w=e.select("#chart2").append("svg").attr("class","pie").attr("height",u).attr("width",c),m=e.select("#chart1").append("svg").attr("class","pie").attr("height",u).attr("width",c).append("g");m.append("g").attr("class","arcs"),m.append("g").attr("class","labels"),m.append("g").attr("class","lines");var b=e.select("#chart3").append("svg").attr("class","pie").attr("height",u).attr("width",c),x=e.select("#tween4").append("svg").attr("class","countdown").attr("height",f).attr("width",p).attr("transform","translate(0,100)").append("text").attr("value","0").style("fill","white");e.select("#tween3").append("svg").attr("class","countdown").attr("height",f).attr("width",p).attr("transform","translate(0,100)").append("text").attr("value","0").style("fill","white"),e.select("#tween5").append("svg").attr("class","countdown").attr("height",f).attr("width",p).attr("transform","translate(0,100)").append("text").attr("value","0").style("fill","white");return{render:a}});